<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Manager Dashboard - KES</title>
    <style>
        body { background: #070707; color: #fff; font-family: sans-serif; padding: 20px; }
        .header { display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #cb0fd1; padding-bottom: 10px; }
        .card { background: #111; padding: 15px; margin: 10px 0; border-radius: 10px; border-left: 5px solid #0d10d8; }
        .status { font-weight: bold; color: #cb0fd1; }
    </style>
</head>
<body>
    <div class="header">
        <h1>Chef d'Équipe</h1>
        <button onclick="location.href='login.html'">Déconnexion</button>
    </div>
    <div id="container">Chargement des données...</div>

    <script>
        const API_URL = "https://script.google.com/macros/s/AKfycbzaMbeswT-HJgWQf2ih8drYrD90lChRpJOnraAukG6M-QrJclhaRRbboqCOahiQCf_5/exec";
        
        async function loadData() {
            const user = JSON.parse(localStorage.getItem('kes_user'));
            const res = await fetch(API_URL, {
                method: 'POST',
                body: JSON.stringify({ action: 'getAllData', auth: { user_id: user.user_id } })
            });
            const data = await res.json();
            let html = "<h3>Interventions</h3>";
            data.interventions.forEach(i => {
                html += `<div class="card">
                    <b>${i.titre}</b> - <span class="status">${i.statut}</span><br>
                    <small>${i.adresse} | Client: ${i.client}</small>
                </div>`;
            });
            document.getElementById('container').innerHTML = html;
        }
        
        window.onload = loadData;
    </script>
</body>
</html>
