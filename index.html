<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>KES Solutions - Maintenance & Bons</title>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300..800&display=swap" rel="stylesheet">

  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Open Sans', sans-serif; }
    body { display: flex; justify-content: center; align-items: flex-start; min-height: 100vh; background: #070707; color: #fff; padding: 50px 20px; transition: background 0.3s, color 0.3s; }
    
    .bg-animation { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 100%; max-width: 900px; height: 100vh; z-index: -1; display: flex; justify-content: center; align-items: center; }
    .bg-animation i { position: absolute; inset: 0; border: 1.5px solid #fff; transition: .5s; border-radius: 40px; }
    .bg-animation i:nth-child(1) { animation: animate 5s linear infinite; --clr: #0078ff; }
    .bg-animation i:nth-child(2) { animation: animate 7s linear infinite; --clr: #ffffff; }
    .bg-animation i:nth-child(3) { animation: animate 11s linear infinite; --clr: #cb0fd1; }
    @keyframes animate { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

    .container { position: relative; width: 100%; max-width: 800px; z-index: 1; }
    .header { text-align: center; margin-bottom: 40px; }
    
    .tabs { display: flex; gap: 5px; margin-bottom: 30px; background: rgba(255,255,255,0.05); padding: 8px; border-radius: 50px; overflow-x: auto; }
    .tab-btn { flex: 1; padding: 12px 15px; border: none; border-radius: 40px; background: transparent; color: #fff; cursor: pointer; font-weight: 700; transition: 0.3s; font-size: 0.75em; white-space: nowrap; }
    .tab-btn.active { background: linear-gradient(45deg, #0d10d8, #cb0fd1); }

    .tab-content { display: none; }
    .tab-content.active { display: block; }

    .glass-card { background: rgba(255, 255, 255, 0.03); border: 2px solid rgba(255, 255, 255, 0.1); border-radius: 35px; padding: 25px; margin-bottom: 25px; backdrop-filter: blur(10px); }
    .section-title { font-size: 1.1em; font-weight: 800; color: #fff; margin-bottom: 20px; text-transform: uppercase; }
    
    .form-input, .form-select, .form-textarea { width: 100%; padding: 14px 25px; background: transparent; border: 2px solid #fff; border-radius: 40px; color: #fff; font-size: 1em; outline: none; margin-bottom: 15px; }
    
    .btn { width: 100%; padding: 16px; border: none; border-radius: 40px; font-weight: 700; cursor: pointer; transition: 0.3s; text-transform: uppercase; }
    .btn-primary { background: linear-gradient(45deg, #0d10d8, #cb0fd1); color: #fff; }

    #signature-pad { border: 2px dashed rgba(255,255,255,0.3); background: #fff; border-radius: 20px; touch-action: none; cursor: crosshair; display: block; margin: 0 auto; }
    #signature-pad.disabled { opacity: 0.2; pointer-events: none; }

    .maint-item { background: rgba(255,255,255,0.05); border-radius: 20px; padding: 15px; margin-bottom: 10px; border-left: 5px solid #4CAF50; }
    .maint-item.urgent { border-left-color: #ff4d4d; animation: pulse-red 2s infinite; }
    @keyframes pulse-red { 0% { box-shadow: 0 0 0 0 rgba(255, 77, 77, 0.4); } 70% { box-shadow: 0 0 0 10px rgba(255, 77, 77, 0); } 100% { box-shadow: 0 0 0 0 rgba(255, 77, 77, 0); } }
    
    #plaque-preview, #c-plaque-preview { max-width: 100%; border-radius: 15px; display: none; margin-bottom: 15px; border: 1px solid #fff; }

    .hist-item { border-bottom: 1px solid rgba(255,255,255,0.1); padding: 15px 0; }
    .hist-client-name { font-weight: bold; color: #0078ff; font-size: 1.2em; display: flex; justify-content: space-between; align-items: center; }
    .btn-del { background: #ff4d4d; border: none; color: white; padding: 5px 10px; border-radius: 5px; font-size: 0.7em; cursor: pointer; }
    .btn-edit { background: #0078ff; border: none; color: white; padding: 5px 10px; border-radius: 5px; font-size: 0.7em; cursor: pointer; margin-right: 5px; }

    body.light-mode { background: #ffffff !important; color: #000000 !important; }
    body.light-mode .glass-card { background: rgba(0, 0, 0, 0.05) !important; border: 2px solid #000000 !important; }
    body.light-mode .form-input, body.light-mode .form-select, body.light-mode .form-textarea { border-color: #000000 !important; color: #000000 !important; }
    body.light-mode .section-title, body.light-mode .header h1, body.light-mode label, body.light-mode .hist-client-name { color: #000000 !important; }
    body.light-mode .bg-animation { display: none; }
    body.light-mode .tab-btn { color: #000; }
    body.light-mode .tab-btn.active { color: #fff; }
  </style>
</head>

<body>
  <button onclick="toggleTheme()" id="theme-toggle" style="position: fixed; top: 10px; right: 10px; z-index: 9999; padding: 10px; border-radius: 50%; border: 2px solid #fff; background: rgba(0,0,0,0.5); cursor: pointer; font-size: 20px;">‚òÄÔ∏è</button>

  <div class="bg-animation"><i></i><i></i><i></i></div>

  <div class="container">
    <div class="header"><h1>KES SOLUTIONS</h1></div>

    <div class="tabs">
      <button class="tab-btn active" onclick="switchTab('profile')">PROFIL</button>
      <button class="tab-btn" onclick="switchTab('new')">√âDITION</button>
      <button class="tab-btn" onclick="switchTab('clients'); renderClients();">CLIENTS</button>
      <button class="tab-btn" onclick="switchTab('maint'); renderMaintenance();">MAINTENANCE</button>
      <button class="tab-btn" onclick="switchTab('hist'); renderHistory();">HISTORIQUE</button>
    </div>

    <div id="content-profile" class="tab-content active">
      <div class="glass-card">
        <h2 class="section-title">üë§ Mon Entreprise</h2>
        <input type="text" id="p-nom" class="form-input" placeholder="Nom / Raison Sociale *">
        <input type="text" id="p-adresse" class="form-input" placeholder="Adresse compl√®te *">
        <input type="text" id="p-tel" class="form-input" placeholder="T√©l√©phone *">
        <input type="email" id="p-email" class="form-input" placeholder="Email *">
        <input type="text" id="p-siret" class="form-input" placeholder="SIRET / RCS">
        <input type="file" id="p-logo-file" class="form-input" accept="image/*" onchange="handleLogo(event)">
        <center><img id="logo-preview" style="max-width:120px; display:none; border-radius:10px; margin: 10px 0;" src=""></center>
        <button onclick="saveProfile()" class="btn btn-primary">Enregistrer</button>
        <button onclick="logout()" class="btn" style="background: #ff4d4d; margin-top: 15px; padding: 10px;">D√©connexion</button>
      </div>
    </div>

    <div id="content-new" class="tab-content">
      <div id="lock-message" class="glass-card" style="border-color: #ff4d4d; text-align: center;">
        <p style="color: #ff4d4d; font-weight: bold;">‚ö†Ô∏è Compl√©tez votre PROFIL d'abord.</p>
      </div>
      <div id="editor-fields" style="display: none;">
         <div class="glass-card">
           <button onclick="createNewBon()" class="btn" style="background: #4CAF50; margin-bottom: 15px;">+ Nouveau bon</button>
           <h3 class="section-title">üìÑ D√©tails du Bon</h3>
           <select id="doc-type" class="form-select">
             <option value="DEVIS" style="color:#000">Devis</option>
             <option value="ENTRETIENT" style="color:#000">Entretient</option>
             <option value="DIAGNOSTIQUE" style="color:#000">Diagnostique</option>
             <option value="DEPANNAGE" style="color:#000">Depannage</option>
             <option value="URGENt" style="color:#000">Urgent</option>
             <option value="FUITE/PLOMBERIE" style="color:#000">Fuite/Plomberie</option>
             <option value="BON DE COMMANDE" style="color:#000">Bon de Commande</option>
             <option value="FACTURE" style="color:#000">Facture</option>
           </select>
           <input type="text" id="client-name" class="form-input" placeholder="Nom du Client">
           <input type="text" id="client-address-doc" class="form-input" placeholder="Adresse du Client">
           <label style="font-size: 0.8em;">Date de passage :</label>
           <input type="date" id="doc-date-passage" class="form-input">
           <textarea id="doc-details" class="form-textarea" rows="4" placeholder="D√©tails de l'intervention"></textarea>
           <textarea id="doc-observation" class="form-textarea" rows="2" placeholder="Observation (optionnel)"></textarea>
           <label style="font-size: 0.8em;">Photos d'intervention (Max 15) :</label>
           <input type="file" id="intervention-photo-file" class="form-input" accept="image/*" multiple onchange="handleInterventionPhoto(event)">
           <div id="intervention-photo-preview" style="display: flex; flex-wrap: wrap; gap: 10px; justify-content: center; margin-top: 10px;"></div>
           <h3 class="section-title" style="margin-top: 20px;">‚úçÔ∏è Signature Client</h3>
           <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px; font-weight: bold;">
             <input type="checkbox" id="no-signature-cb" onchange="toggleNoSignature()">
             <label for="no-signature-cb">Client absent (Pas de signature)</label>
           </div>
           <canvas id="signature-pad" width="400" height="200" style="background:#fff;"></canvas>
           <button type="button" class="btn" id="btn-clear-sig" onclick="clearSignature()" style="background:#ff4d4d; padding: 10px; margin-top:10px;">Effacer signature</button>
         </div>
         <button onclick="generatePDF()" id="btn-generate" class="btn btn-primary">G√©n√©rer le PDF</button>
      </div>
    </div>

    <div id="content-clients" class="tab-content">
      <div class="glass-card">
        <h2 class="section-title">üë• Nouveau Client</h2>
        <select id="c-type" class="form-select">
          <option value="Particulier" style="color:#000">Particulier</option>
          <option value="Soci√©t√©" style="color:#000">Soci√©t√©</option>
        </select>
        <input type="text" id="c-nom" class="form-input" placeholder="Nom ou Raison Sociale *">
        <input type="text" id="c-adresse" class="form-input" placeholder="Adresse compl√®te">
        <input type="text" id="c-marque" class="form-input" placeholder="Marque de la chaudi√®re">
        <label style="font-size: 0.8em;">Photo Plaque Signal√©tique :</label>
        <input type="file" id="c-plaque-file" class="form-input" accept="image/*" onchange="handleClientPlaque(event)">
        <center><img id="c-plaque-preview" src=""></center>
        <button onclick="saveClient()" class="btn btn-primary">Enregistrer le client</button>
      </div>
      <div class="glass-card">
        <h2 class="section-title">üè¢ Soci√©t√©s</h2>
        <div id="clients-list-societes"></div>
      </div>
      <div class="glass-card">
        <h2 class="section-title">üë§ Particuliers</h2>
        <div id="clients-list-particuliers"></div>
      </div>
    </div>

    <div id="content-maint" class="tab-content">
      <div class="glass-card">
        <h2 class="section-title">üìÖ Planifier Maintenance</h2>
        <input type="text" id="m-client" class="form-input" placeholder="Nom du Client *">
        <input type="text" id="m-client-address" class="form-input" placeholder="Adresse du Client">
        <input type="text" id="m-chaudiere" class="form-input" placeholder="Mod√®le de la Chaudi√®re">
        <label style="font-size: 0.8em;">Photo Plaque Signal√©tique :</label>
        <input type="file" id="m-plaque-file" class="form-input" accept="image/*" onchange="previewPlaque(event)">
        <img id="plaque-preview" src="">
        <div style="display:flex; gap:10px;">
          <div style="flex:1"><label style="font-size: 0.7em;">Entretien Jour :</label><input type="date" id="m-date-now" class="form-input"></div>
          <div style="flex:1"><label style="font-size: 0.7em;">Prochain Passage :</label><input type="date" id="m-date-next" class="form-input"></div>
        </div>
        <button onclick="saveMaintenance()" class="btn btn-primary">Enregistrer le rappel</button>
      </div>
      <div class="glass-card">
        <h2 class="section-title">üîî Rappels √† venir</h2>
        <div id="maint-list"></div>
      </div>
    </div>

    <div id="content-hist" class="tab-content">
      <div class="glass-card">
        <h2 class="section-title">üóÇÔ∏è Historique des bons</h2>
        <div id="history-list"></div>
      </div>
    </div>
  </div>

  <script>
    let logoData = null;
    let plaqueData = null;
    let clientPlaqueData = null;
    let interventionPhotos = [];
    let isDrawing = false;
    let signatureEmpty = true;
    let currentEditId = null;

    window.onload = function() {
      loadProfile();
      validateProfile();
      document.getElementById('doc-date-passage').valueAsDate = new Date();
      document.getElementById('m-date-now').valueAsDate = new Date();
      initSignaturePad();
    };

    function toggleTheme() {
      document.body.classList.toggle('light-mode');
      document.getElementById('theme-toggle').innerText = document.body.classList.contains('light-mode') ? "üåô" : "‚òÄÔ∏è";
    }

    function switchTab(t) {
      document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
      document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
      document.getElementById('content-'+t).classList.add('active');
      const btn = Array.from(document.querySelectorAll('.tab-btn')).find(b => b.getAttribute('onclick').includes(t));
      if(btn) btn.classList.add('active');
    }

    // GESTION CLIENTS
    function handleClientPlaque(event) {
      const r = new FileReader();
      r.onload = (e) => {
        clientPlaqueData = e.target.result;
        document.getElementById('c-plaque-preview').src = clientPlaqueData;
        document.getElementById('c-plaque-preview').style.display = 'block';
      };
      r.readAsDataURL(event.target.files[0]);
    }

    function saveClient() {
      const nom = document.getElementById('c-nom').value;
      const type = document.getElementById('c-type').value;
      const addr = document.getElementById('c-adresse').value;
      const marque = document.getElementById('c-marque').value;
      if (!nom) { alert("Le nom est obligatoire"); return; }
      const newClient = { id: Date.now(), nom, type, adresse: addr, marque, photo: clientPlaqueData };
      let clients = JSON.parse(localStorage.getItem('kes_clients_list') || '[]');
      clients.push(newClient);
      localStorage.setItem('kes_clients_list', JSON.stringify(clients));
      document.getElementById('c-nom').value = ""; document.getElementById('c-adresse').value = ""; document.getElementById('c-marque').value = "";
      document.getElementById('c-plaque-preview').style.display = "none"; clientPlaqueData = null;
      alert("Client enregistr√© !");
      renderClients();
    }

    function renderClients() {
      const listSoc = document.getElementById('clients-list-societes');
      const listPart = document.getElementById('clients-list-particuliers');
      const clients = JSON.parse(localStorage.getItem('kes_clients_list') || '[]');
      listSoc.innerHTML = ""; listPart.innerHTML = "";
      clients.forEach(c => {
        const div = document.createElement('div');
        div.className = 'maint-item';
        div.style.borderLeftColor = c.type === 'Soci√©t√©' ? '#cb0fd1' : '#0078ff';
        div.innerHTML = `
          <div style="display:flex; justify-content:space-between; align-items:flex-start;">
            <div style="flex:1;">
              <strong>${c.nom}</strong><br><small>üìç ${c.adresse || 'N/A'}</small><br><small>üîß ${c.marque || 'N/A'}</small>
            </div>
            <div style="display:flex; flex-direction:column; gap:5px;">
              <button onclick="selectClientForDoc('${c.nom.replace(/'/g, "\\'")}', '${c.adresse.replace(/'/g, "\\'")}')" style="background:#4CAF50; border:none; color:#fff; padding:5px 10px; border-radius:10px; cursor:pointer; font-size:0.7em;">SELECT</button>
              <button onclick="deleteClient(${c.id})" style="background:#ff4d4d; border:none; color:#fff; padding:5px 10px; border-radius:10px; cursor:pointer; font-size:0.7em;">SUPPR</button>
            </div>
          </div>`;
        if(c.type === 'Soci√©t√©') listSoc.appendChild(div); else listPart.appendChild(div);
      });
    }

    function deleteClient(id) {
      if(!confirm("Supprimer ce client ?")) return;
      let clients = JSON.parse(localStorage.getItem('kes_clients_list') || '[]');
      clients = clients.filter(c => c.id !== id);
      localStorage.setItem('kes_clients_list', JSON.stringify(clients));
      renderClients();
    }

    function selectClientForDoc(nom, adresse) {
      document.getElementById('client-name').value = nom;
      document.getElementById('client-address-doc').value = adresse;
      switchTab('new');
    }

    // GESTION BONS & PDF
    function handleInterventionPhoto(event) {
      const preview = document.getElementById('intervention-photo-preview');
      preview.innerHTML = ""; interventionPhotos = [];
      const files = Array.from(event.target.files);
      files.forEach(file => {
        const reader = new FileReader();
        reader.onload = (e) => { 
          interventionPhotos.push(e.target.result);
          const img = document.createElement('img'); img.src = e.target.result;
          img.style = "width:80px; height:80px; object-fit:cover; border-radius:10px; border:1px solid #fff;";
          preview.appendChild(img);
        };
        reader.readAsDataURL(file);
      });
    }

    async function generatePDF() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();
      const p = JSON.parse(localStorage.getItem('kes_user_profile') || '{}');
      const cName = document.getElementById('client-name').value || "Client Inconnu";
      
      // Sauvegarde Historique
      let history = JSON.parse(localStorage.getItem('kes_full_history') || '[]');
      const newEntry = {
        id: currentEditId || Date.now(),
        client: cName,
        address: document.getElementById('client-address-doc').value,
        date: document.getElementById('doc-date-passage').value,
        type: document.getElementById('doc-type').value,
        details: document.getElementById('doc-details').value,
        observation: document.getElementById('doc-observation').value,
        photos: [...interventionPhotos]
      };

      if(currentEditId) {
        const idx = history.findIndex(h => h.id === currentEditId);
        if(idx !== -1) history[idx] = newEntry;
      } else {
        history.unshift(newEntry);
      }
      localStorage.setItem('kes_full_history', JSON.stringify(history));
      currentEditId = null;

      // PDF Generation
      if(p.logo) doc.addImage(p.logo, 'PNG', 150, 10, 40, 40);
      doc.setFontSize(14).text(p.nom || "", 20, 20);
      doc.setFontSize(11).text([p.addr || "", p.tel || "", p.mail || ""], 20, 28);
      doc.line(20, 50, 190, 50);
      doc.setFontSize(18).text(document.getElementById('doc-type').value, 20, 65);
      doc.setFontSize(12).text("CLIENT : " + cName, 20, 75);
      doc.text("DATE : " + document.getElementById('doc-date-passage').value, 20, 92);
      doc.text("DETAILS :", 20, 105);
      doc.text(doc.splitTextToSize(document.getElementById('doc-details').value, 170), 20, 112);
      
      if(!document.getElementById('no-signature-cb').checked && !signatureEmpty) {
        doc.addImage(document.getElementById('signature-pad').toDataURL('image/png'), 'PNG', 20, 200, 50, 25);
      }
      doc.save(`BON_${Date.now()}.pdf`);
      alert("Bon enregistr√© !");
      renderHistory();
    }

    function renderHistory() {
      const list = document.getElementById('history-list');
      const history = JSON.parse(localStorage.getItem('kes_full_history') || '[]');
      list.innerHTML = "";
      history.forEach(item => {
        const div = document.createElement('div');
        div.className = 'hist-item';
        div.innerHTML = `
          <div class="hist-client-name">
            <span>${item.client} (${item.date})</span>
            <div>
              <button class="btn-edit" onclick="loadForEdit(${item.id})">EDIT</button>
              <button class="btn-del" onclick="deleteEntry(${item.id})">SUPPR</button>
            </div>
          </div>`;
        list.appendChild(div);
      });
    }

    function loadForEdit(id) {
      const history = JSON.parse(localStorage.getItem('kes_full_history') || '[]');
      const item = history.find(h => h.id === id);
      if(!item) return;
      currentEditId = id;
      document.getElementById('doc-type').value = item.type;
      document.getElementById('client-name').value = item.client;
      document.getElementById('client-address-doc').value = item.address;
      document.getElementById('doc-date-passage').value = item.date;
      document.getElementById('doc-details').value = item.details;
      document.getElementById('doc-observation').value = item.observation;
      switchTab('new');
    }

    function deleteEntry(id) {
      if(!confirm("Supprimer ce bon ?")) return;
      let history = JSON.parse(localStorage.getItem('kes_full_history') || '[]');
      history = history.filter(h => h.id !== id);
      localStorage.setItem('kes_full_history', JSON.stringify(history));
      renderHistory();
    }

    // FONCTIONS PROFIL & MAINT (Inchang√©es)
    function saveProfile() { const p={nom:document.getElementById('p-nom').value, addr:document.getElementById('p-adresse').value, tel:document.getElementById('p-tel').value, mail:document.getElementById('p-email').value, siret:document.getElementById('p-siret').value, logo:logoData}; localStorage.setItem('kes_user_profile', JSON.stringify(p)); validateProfile(); alert("Profil sauv√©"); }
    function loadProfile() { const p=JSON.parse(localStorage.getItem('kes_user_profile')||'{}'); if(p.nom){ document.getElementById('p-nom').value=p.nom; document.getElementById('p-adresse').value=p.addr; document.getElementById('p-tel').value=p.tel; document.getElementById('p-email').value=p.mail; document.getElementById('p-siret').value=p.siret||""; logoData=p.logo; if(p.logo){document.getElementById('logo-preview').src=p.logo; document.getElementById('logo-preview').style.display='block';}}}
    function validateProfile() { const p=JSON.parse(localStorage.getItem('kes_user_profile')||'{}'); const ok=p.nom&&p.addr; document.getElementById('lock-message').style.display=ok?'none':'block'; document.getElementById('editor-fields').style.display=ok?'block':'none'; }
    function logout() { sessionStorage.clear(); location.reload(); }
    function handleLogo(e) { const r=new FileReader(); r.onload=(ev)=>{logoData=ev.target.result; document.getElementById('logo-preview').src=logoData; document.getElementById('logo-preview').style.display='block';}; r.readAsDataURL(e.target.files[0]); }
    function initSignaturePad() { const c=document.getElementById('signature-pad'); const ctx=c.getContext('2d'); ctx.lineWidth=3; const s=()=>{if(document.getElementById('no-signature-cb').checked)return;isDrawing=true;signatureEmpty=false;ctx.beginPath();}; const m=(e)=>{if(!isDrawing)return;e.preventDefault();const r=c.getBoundingClientRect();ctx.lineTo((e.touches?e.touches[0].clientX:e.clientX)-r.left,(e.touches?e.touches[0].clientY:e.clientY)-r.top);ctx.stroke();}; c.addEventListener('mousedown',s);c.addEventListener('mousemove',m);window.addEventListener('mouseup',()=>isDrawing=false); }
    function clearSignature(){const c=document.getElementById('signature-pad');c.getContext('2d').clearRect(0,0,c.width,c.height);signatureEmpty=true;}
    function toggleNoSignature(){document.getElementById('signature-pad').classList.toggle('disabled',document.getElementById('no-signature-cb').checked);}
    function createNewBon(){currentEditId=null;document.getElementById('client-name').value="";document.getElementById('doc-details').value="";clearSignature();}
    function previewPlaque(e){const r=new FileReader();r.onload=(ev)=>{plaqueData=ev.target.result;document.getElementById('plaque-preview').src=plaqueData;document.getElementById('plaque-preview').style.display='block';};r.readAsDataURL(e.target.files[0]);}
    function saveMaintenance(){ const c=document.getElementById('m-client').value; const n=document.getElementById('m-date-next').value; if(!c||!n)return; let m=JSON.parse(localStorage.getItem('kes_maintenances')||'[]'); m.push({client:c,dateNext:n,id:Date.now()}); localStorage.setItem('kes_maintenances',JSON.stringify(m)); renderMaintenance(); }
    function renderMaintenance(){ const l=document.getElementById('maint-list'); const m=JSON.parse(localStorage.getItem('kes_maintenances')||'[]'); l.innerHTML=m.length===0?"<p>Aucun rappel.</p>":""; m.forEach(x=>{const div=document.createElement('div');div.className='maint-item';div.innerHTML=`<strong>${x.client}</strong><br>Prochain : ${x.dateNext}`;l.appendChild(div);});}
  </script>
</body>
</html>